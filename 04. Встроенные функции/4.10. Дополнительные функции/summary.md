# Дополнительные функции

- [Дополнительные функции](#дополнительные-функции)
  - [Функция ISNULL()](#функция-isnull)
  - [Функция IF()](#функция-if)
  - [Функция COALESCE()](#функция-coalesce)
  - [Функция IFNULL()](#функция-ifnull)
  - [Функция NULLIF()](#функция-nullif)
  - [Функции CONVERT() и CAST()](#функции-convert-и-cast)

## Функция ISNULL()

Функция `ISNULL()` используется для проверки значения на `NULL`. Она принимает в качестве аргумента произвольное значение и возвращает `1`, если переданным значением является `NULL`, или `0` в противном случае.

Результатом приведенного ниже запроса:

```sql
SELECT ISNULL(0),
       ISNULL(1),
       ISNULL(1.1),
       ISNULL(''),
       ISNULL('bee'),
       ISNULL(NULL);
```

является:

```sql
+-----------+-----------+-------------+------------+---------------+--------------+
| ISNULL(0) | ISNULL(1) | ISNULL(1.1) | ISNULL('') | ISNULL('bee') | ISNULL(NULL) |
+-----------+-----------+-------------+------------+---------------+--------------+
| 0         | 0         | 0           | 0          | 0             | 1            |
+-----------+-----------+-------------+------------+---------------+--------------+
```

## Функция IF()

Функция `IF()` используется для выбора одного из двух значений в зависимости от результата некоторого условного выражения. Она принимает три аргумента в следующем порядке:

- `condition` — условное выражение
- `value1` — произвольное значение
- `value2` — произвольное значение

Функция возвращает значение `value1`, если условное выражение `condition` истинно, или значение `value2` в противном случае.

Результатом приведенного ниже запроса:

```sql
SELECT IF(1 > 0, 'bee', 'geek'),
       IF(1 < 0, 'bee', 'geek');
```

является:

```sql
+--------------------------+--------------------------+
| IF(1 > 0, 'bee', 'geek') | IF(1 < 0, 'bee', 'geek') |
+--------------------------+--------------------------+
| bee                      | geek                     |
+--------------------------+--------------------------+
```

## Функция COALESCE()

Функция `COALESCE()` используется для поиска первого непустого значения. Она принимает переменное количество аргументов и возвращает первый из них, не равный `NULL`.

Результатом приведенного ниже запроса:

```sql
SELECT COALESCE(1, 2, 3),
       COALESCE(NULL, 2, 3),
       COALESCE(1, NULL, 3),
       COALESCE(NULL, NULL, 3);
```

является:

```sql
+-------------------+----------------------+----------------------+-------------------------+
| COALESCE(1, 2, 3) | COALESCE(NULL, 2, 3) | COALESCE(1, NULL, 3) | COALESCE(NULL, NULL, 3) |
+-------------------+----------------------+----------------------+-------------------------+
| 1                 | 2                    | 1                    | 3                       |
+-------------------+----------------------+----------------------+-------------------------+
```

Если все аргументы, переданные в функцию `COALESCE()`, являются значением `NULL`, возвращаемым значением функции также будет значение `NULL`.

Результатом приведенного ниже запроса:

```sql
SELECT COALESCE(NULL),
       COALESCE(NULL, NULL);
```

является:

```sql
+----------------+----------------------+
| COALESCE(NULL) | COALESCE(NULL, NULL) |
+----------------+----------------------+
| NULL           | NULL                 |
+----------------+----------------------+
```

## Функция IFNULL()

Функция `IFNULL()` используется для замены некоторого значения на альтернативное, если исходное значение равняется `NULL`. Она принимает два аргумента в следующем порядке:

- `value` — исходное значение
- `alternative_value` — альтернативное значение

Функция возвращает значение `value`, если оно не равняется `NULL`, или значение `alternative_value` в противном случае.

Результатом приведенного ниже запроса:

```sql
SELECT IFNULL(NULL, 'geek'),
       IFNULL('bee', 'geek');
```

является:

```sql
+----------------------+-----------------------+
| IFNULL(NULL, 'geek') | IFNULL('bee', 'geek') |
+----------------------+-----------------------+
| geek                 | bee                   |
+----------------------+-----------------------+
```

## Функция NULLIF()

Функция `NULLIF()` используется для сравнения двух значений. Она принимает два аргумента в следующем порядке:

- `value1` — произвольное значение
- `value2` — произвольное значение

Функция возвращает значение `NULL`, если значения `value1` и `value2` совпадают, или значение `value1` в противном случае.

Результатом приведенного ниже запроса:

```sql
SELECT NULLIF('bee', 'bee'),
       NULLIF('bee', 'geek');
```

является:

```sql
+----------------------+-----------------------+
| NULLIF('bee', 'bee') | NULLIF('bee', 'geek') |
+----------------------+-----------------------+
| NULL                 | bee                   |
+----------------------+-----------------------+
```

## Функции CONVERT() и CAST()

Во время выполнения операций со значениями разных типов происходит автоматическое приведение этих значений к одному типу. Например, при попытке сложить число и строку СУБД сначала конвертирует прибавляемую строку в число.

Результатом приведенного ниже запроса:

```sql
SELECT 1 + '15';
```

является:

```sql
+----------+
| 1 + '15' |
+----------+
| 16.0     |
+----------+
```

Однако не всегда СУБД может автоматически привести используемые значения к нужному типу для корректного выполнения операции, поэтому иногда это приходится делать вручную. В SQL для преобразования типов используются функции `CONVERT()` и `CAST()`.

Функция `CONVERT()` принимает два аргумента в следующем порядке:

- `value` — значение, которое необходимо преобразовать
- `type` — желаемый тип

Функция приводит значение `value` к типу `type` и возвращает полученный результат.

Результатом приведенного ниже запроса:

```sql
SELECT CONVERT(100.78, DECIMAL(4, 1)),
       CONVERT(100.78, DECIMAL(3, 0));
```

является:

```sql
+--------------------------------+--------------------------------+
| CONVERT(100.78, DECIMAL(4, 1)) | CONVERT(100.78, DECIMAL(3, 0)) |
+--------------------------------+--------------------------------+
| 100.8                          | 101                            |
+--------------------------------+--------------------------------+
```

Функция `CONVERT()` умеет приводить значение к следующим типам:

![](https://i.ibb.co/Hz9wkx0/image.png)

Значение, приводимое к определенному типу, должно соответствовать формату этого типа, в противном случае функция `CONVERT()` вернет значение `NULL`.

Результатом приведенного ниже запроса:

```sql
SELECT CONVERT('2023-01-01', DATE),
       CONVERT('beegeek', DATE);
```

является:

```sql
+-----------------------------+--------------------------+
| CONVERT('2023-01-01', DATE) | CONVERT('beegeek', DATE) |
+-----------------------------+--------------------------+
| 2023-01-01                  | NULL                     |
+-----------------------------+--------------------------+
```

Однако при попытке привести несоответствующее формату значение к числовому типу функция `CONVERT()` вернет значение `0`.

Результатом приведенного ниже запроса:

```sql
SELECT CONVERT('beegeek', SIGNED),
       CONVERT('beegeek', UNSIGNED),
       CONVERT('beegeek', DECIMAL(5, 2));
```

является:

```sql
+----------------------------+------------------------------+-----------------------------------+
| CONVERT('beegeek', SIGNED) | CONVERT('beegeek', UNSIGNED) | CONVERT('beegeek', DECIMAL(5, 2)) |
+----------------------------+------------------------------+-----------------------------------+
| 0                          | 0                            | 0.00                              |
+----------------------------+------------------------------+-----------------------------------+
```

Похожим образом себя ведет функция `CAST()` за тем исключением, что она разделяет передаваемые аргументы не запятой, а ключевым словом `AS`.

Результатом приведенного ниже запроса:

```sql
SELECT CAST(100.78 AS DECIMAL(4, 1)),
       CAST(100.78 AS DECIMAL(3, 0));
```

является:

```sql
+-------------------------------+-------------------------------+
| CAST(100.78 AS DECIMAL(4, 1)) | CAST(100.78 AS DECIMAL(3, 0)) |
+-------------------------------+-------------------------------+
| 100.8                         | 101                           |
+-------------------------------+-------------------------------+
```
